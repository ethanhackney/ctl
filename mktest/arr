#!/bin/bash

# bare minimum needed to work
if [ -z "$CTL_ROOT" ]; then
  echo "mkarrtest: CTL_ROOT undefined" 2>&1
  exit 1
fi
if [ -z "$CTL_ENV" ]; then
  echo "mkarrtest: CTL_ENV undefined" 2>&1
  exit 1
fi

# grab environment
source "$CTL_ENV"

# bring in library

source "$CTL_BASH_LIB"

# switch to our directory
docdir=$(dirname $0)
cd "$docdir"

do_or_die echo "/* $CTL_AUTO_GEN_MSG */" >"$CTL_TEST/do/arr.c"
do_or_die echo "#include \"$CTL_LIB/lib.h\"" >>"$CTL_TEST/do/arr.c"
do_or_die echo "#include \"$CTL_TMP/arr.h\"" >>"$CTL_TEST/do/arr.c"

do_or_die ./gen.awk -v SILENT=$silent "./tab/arr" >>"$CTL_TEST/do/arr.c"
